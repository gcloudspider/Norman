/**
* Create Date:2016年01月23日 星期六 14时54分40秒
* 
* Author:Norman
* 
* Description: 
*/

####进程对内存分配和管理:
    从用户向内核看:
        逻辑地址(逻辑地址段机制转化成线性地址)
        线性地址(线性地址又经过页机制转化为物理地址)
        物理地址

####进程内存空间:
    Linux操作系统采用虚拟内存管理技术.每个进程各自互不干涉的进程地址空间.
    该空间块大小为4G线性虚拟空间
    4G进程地址空间分为:
        用户空间(0~3G):
            1.用户进程通常只能访问用户空间虚拟地址,不能访问内核空间虚拟地址
            2.用户空间进程切换,用户空间就会跟着变化
            3.每个进程用户空间独立,互不干扰的
        内核空间(3G~4G):
            1.用户进程进行系统调用时可以访问内核空间
            2.内核空间凡内核负责映射,不会随进程改变,固定的,内核空间地址有自己对应页表,用户进程各有不同页表
    
####进程内存管理:
    进程内存管理的对象是进程线性地址空间上的内存镜像!
    内存镜像:
        就是进程使用的虚拟内存区域
    进程虚拟空间:
        1.是32或64位独立连续区间地址空间.
        2.虚拟空间被划分为许多大小可变(4096倍数)内存区域,这些区域在进程线性地址中有序排列
        3.划分原则:将访问属性一致的地址空间存放在一起。(可读,可写,可执行)

    Linux内核中对应进程内存区域数据结构是:vm_area_struct
    内核将每个内存区域作为一个单独的内存对象管理,相应操作也一致,采用面向对象方法使VMA结构体可以代表多种类型内存区域

    1.vm_area_struct描述进程地址空间基本管理单元.
    2.vm_area_struct结构以链表形式链接关联不同内存区域
    3.为方便查找,内核又以红黑树形式组织内存区域,以便降低搜索耗时,并存两种形式,并非冗余
        链表用于需要遍历全部节点时用。
        红黑树形组织内存区域,降低内存区域上各种不同操作都能获得高性能

    进程地址空间对应描述结构是"内存描述符结构"它表示进程全部地址空间
    包含了进程地址空间有关全部信息,当然包含进程的内存区域

####进程内存分配与回收:
    1.内存申请获得不是实际内存,而是虚拟内存(最终会归结到do_mmap()函数上) brk调用被单独以系统调用实现
    2.内核使用do_mmap()函数创建一个新的线性地址区间.
    3.释放一个内存区域使用do_ummap() 销毁对应内存区域

####虚拟地址转为物理地址:
    1.申请内存仅是对一个新的线性地址区间使用权.
    2.物理内存只有当进程去访问新获取的虚拟地址时,才会由"请求页机制"产生缺页异常,从而进入分配实际页面的例程

